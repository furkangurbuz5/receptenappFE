<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recepten</title>

    <script src="js/script.js"></script>
    <script>
        window.onload=function(){
            menu();
        }

        function toonRecepten(){
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function(){
            if(this.readyState == 4){
               console.log(this.responseText); 
               var alleRecepten = JSON.parse(this.responseText);
               var eindString = "<table border=1>"
               for(var x = 0; x < alleRecepten.length; x++){
                 eindString += 
                 "<tr><td id=\"naamfield"+alleRecepten[x].id+"\">"+alleRecepten[x].naam+"</td></tr>"+
                 "<tr><td id =\"aantalfield"+alleRecepten[x].id+"\">"+alleRecepten[x].aantal+"</td></tr>"+
                 "<tr><td id =\"calorieenfield"+alleRecepten[x].id+"\">"+alleRecepten[x].calorieen+"</td></tr>"+
                 "<tr><td id =\"ingredientenfield"+alleRecepten[x].id+"\">"+alleRecepten[x].ingredienten+"</td></tr>"+
                 "<tr><td id =\"bereidingfield"+alleRecepten[x].id+"\">"+alleRecepten[x].bereiding+"</td></tr>"+
                 "<tr><td id =\"landfield"+alleRecepten[x].id+"\">"+alleRecepten[x].land+"</td></tr>"+
                 "<tr><td id =\"tijdfield"+alleRecepten[x].id+"\">"+alleRecepten[x].tijd+"</td></tr>"+
                 "<tr><td><button onclick=verwijderen("+alleRecepten[x].id+")>Verwijder</button></td><td><button onclick=aanpassen("+alleRecepten[x].id+")>Aanpassen</button></td><td><button onclick=opslaan("+alleRecepten[x].id+")>Opslaan</button></tr>"
               
                

               }
               eindString += "</table>";
               document.getElementById("alleReceptenTabel").innerHTML = eindString;
            }
        }
        xhr.open("GET",db+"/derecepten", true);
        xhr.send();
    }
    function toevoegen(){
        
        var derecept = {};
        derecept.naam = document.getElementById("naamrecept").value;

        derecept.aantal = document.getElementById("aantalmensen").value;
        derecept.categorie = {
                } 
        derecept.categorie.id = 1;
        derecept.calorieen = document.getElementById("calorieen").value;
        derecept.ingredienten = document.getElementById("ingredienten").value;
        derecept.land = document.getElementById("land").value;
        derecept.tijd = document.getElementById("kooktijd").value;
        derecept.bereiding = document.getElementById("bereiding").value;


        var deJSON = JSON.stringify(derecept);
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function(){
            if(this.readyState == 4){
               console.log("toevoegen gelukt");
            }
        }
        xhr.open("POST",db+"/voegrecepttoe", true);
        xhr.setRequestHeader("Content-Type","application/json");
        xhr.send(deJSON);
    }
    

    function verwijderen(deid){
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function(){
            if(this.readyState == 4){

            }
        }
        xhr.open("DELETE", "http://localhost:8082/verwijderrecept/"+deid, true);
        xhr.send();
    }

    function aanpassen(deid){
        alert(deid);
        document.getElementById("naamfield"+deid).innerHTML="<input id=\"naamrecepta\">"
        document.getElementById("aantalfield"+deid).innerHTML="<input id=\"aantalrecepta\">"
        document.getElementById("calorieenfield"+deid).innerHTML="<input id=\"calorieenrecepta\">"
        document.getElementById("ingredientenfield"+deid).innerHTML="<input id=\"ingredientenrecepta\">"
        document.getElementById("bereidingfield"+deid).innerHTML="<input id=\"bereidingrecepta\">"
        document.getElementById("landfield"+deid).innerHTML="<input id=\"landrecepta\">"
        document.getElementById("tijdfield"+deid).innerHTML="<input id=\"tijdrecepta\">"
        
      

    }

    function opslaan(deid, nieuwenaam){
        var derecept= {};
        derecept.naam = document.getElementById("naamrecepta").value;
        derecept.aantal = document.getElementById("aantalrecepta").value;
        derecept.calorieen = document.getElementById("calorieenrecepta").value;
        derecept.ingredienten = document.getElementById("ingredientenrecepta").value;
        derecept.bereiding = document.getElementById("bereidingrecepta").value;
        derecept.land = document.getElementById("landrecepta").value;
        derecept.tijd = document.getElementById("tijdrecepta").value;
        alert(derecept.naam);
        var deJSON = JSON.stringify(derecept);
        var xhr = new XMLHttpRequest();
        xhr.open("PUT","http://localhost:8082/recept/aanpassen/"+deid+"/"+derecept.naam, true );
        xhr.setRequestHeader("Content-type", "application/json");
        if(this.readyState == 4){

        }
        xhr.send(deJSON);   
        }

    function zoeken(zoekopdracht){
        if(zoekopdracht!=""){
            var xhr = new XMLHttpRequest();
            var eindString = "<table border=1>";
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    var gezocht = JSON.parse(this.responseText)

                    for(var x = 0;x<gezocht.length;x++){
                        eindString +=
                            "<tr><td>" +gezocht[x].naam+
                            "</td><td>" +gezocht[x].aantal+
                            "</td><td>" +gezocht[x].calorieen+
                            "</td><td>" +gezocht[x].ingredienten+
                            "</td><td>" +gezocht[x].bereiding+
                            "</td><td>" +gezocht[x].land+
                            "</td><td>" +gezocht[x].tijd+
                            "</td></tr>"

                    }
                    eindString += "</table>";
                    document.getElementById("gezochtTabel").innerHTML = eindString;
                }
            }
            console.log(parseInt(zoekopdracht));
            if(isNaN(parseInt(zoekopdracht))){
                xhr.open("GET", "http://localhost:8082/zoekreceptnaam/"+zoekopdracht, true);
                xhr.send();
                console.log(zoekopdracht);
                console.log(document.getElementById("inputzoekrecept").type)
            } else {
                xhr.open("GET", "http://http://localhost:8082/zoekrecepttijd/"+zoekopdracht, true);
                xhr.send();
                console.log(zoekopdracht)
            }
        }else{
            alert("Zoek veld leeg");
        }
    }
        
        
    
    </script>
</head>

<style>
    label {
        display:inline-block;
        width:200px;
        font-family:Verdana, Geneva, Tahoma, sans-serif;
        margin-bottom:10px;
    }
    li{
        list-style:none;
    }
    header{
        font-family:Verdana, Geneva, Tahoma, sans-serif;
    }
    div{
        margin-top:10px;
        margin-bottom:10px;
    }
    td{
        margin-bottom:10px;
    }
</style>
<body>
    <div id="menudiv"></div>
    <header> <h1>ReceptenApp! - Recepten </h1></header>
        <header><h4>Voeg recept toe:</h2></header>
    <li>
     <label for="naamrecept">Naam:</label>
     <input id="naamrecept">
    </li>

    <li>
     <label for="aantalmensen">Aantal Personen:</label>
     <input id="aantalmensen">
    </li>
    
    <li>
     <label for="calorieen">Calorieen:</label>
     <input id="calorieen">
    </li>

    <li>
     <label for="ingredienten">Ingredienten:</label>
     <input id="ingredienten">
    </li>

    <li>
        <label for="bereiding">Bereidingswijze:</label>
        <input id="bereiding">
    </li>
    
    <li>
     <label for="land">Land Van Herkomst:</label>
     <input id="land">
    </li>

    <li>
     <label for="kooktijd">Kooktijd:</label>
     <input id="kooktijd">
    </li>
    
    <button onclick="toevoegen()">Toevoegen</button>
    <button onclick="toonRecepten()">Toon alle Recepten</button>
    <div id="alleReceptenTabel"></div>

    <header><h4>Zoek op naam recept:</h4></header>
    <input id="inputzoekrecept">
    <button onclick="zoeken(document.getElementById('inputzoekrecept').value)">Zoek</button><br>
    <div id="gezochtTabel"></div>


</body>
</html>